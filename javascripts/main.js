


    //--------------------------------------------------------------------------------------------------------
	//
	// 
    //
	//--------------------------------------------------------------------------------------------------------
		// 
    var dataGroup = [
    {
        "year": 2010.12,
        "agency": "Department of Human Services",
        "category": "Assistance and Grants",
        "total": "145473573.68",
        "num_records": 4579
    },
    {
        "year": 2010.22,
        "agency": "Department of Human Services",
        "category": "Salary/Wages",
        "total": "50255725.13",
        "num_records": 138
    },
    {
        "year": 2010.32,
        "agency": "Department of Human Services",
        "category": "Contracted Professional Services",
        "total": "39652674.43",
        "num_records": 1914
    },
    {
        "year": 2010.42,
        "agency": "Department of Human Services",
        "category": "Benefits",
        "total": "25374538.32",
        "num_records": 157
    },
    {
        "year": 2010.52,
        "agency": "Department of Human Services",
        "category": "Operating Supplies and Expenses",
        "total": "12278049.16",
        "num_records": 11606
    },
    {
        "year": 2010.62,
        "agency": "Department of Human Services",
        "category": "Operating Transfers",
        "total": "4170058.14",
        "num_records": 13
    },
    {
        "year": 2010.72,
        "agency": "Department of Human Services",
        "category": "Capital Purchases and Equipment",
        "total": "1524210.94",
        "num_records": 80
    },
    {
        "year": 2011.12,
        "agency": "Department of Human Services",
        "category": "Assistance and Grants",
        "total": "151876880.22",
        "num_records": 4521
    },
    {
        "year": 2011.22,
        "agency": "Department of Human Services",
        "category": "Salary/Wages",
        "total": "54391031.9",
        "num_records": 136
    },
    {
        "year": 2011.32,
        "agency": "Department of Human Services",
        "category": "Contracted Professional Services",
        "total": "50368435.46",
        "num_records": 2167
    },
    {
        "year": 2011.42,
        "agency": "Department of Human Services",
        "category": "Benefits",
        "total": "28995462.11",
        "num_records": 142
    },
    {
        "year": 2011.52,
        "agency": "Department of Human Services",
        "category": "Operating Supplies and Expenses",
        "total": "11601306.14",
        "num_records": 11526
    },
    {
        "year": 2011.62,
        "agency": "Department of Human Services",
        "category": "Operating Transfers",
        "total": "5648603.5",
        "num_records": 19
    },
    {
        "year": 2011.72,
        "agency": "Department of Human Services",
        "category": "Capital Purchases and Equipment",
        "total": "354665.51",
        "num_records": 34
    },
    {
        "year": 2012.12,
        "agency": "Department of Human Services",
        "category": "Assistance and Grants",
        "total": "117241888.25",
        "num_records": 4735
    },
    {
        "year": 2012.22,
        "agency": "Department of Human Services",
        "category": "Salary/Wages",
        "total": "52638658.96",
        "num_records": 183
    },
    {
        "year": 2012.32,
        "agency": "Department of Human Services",
        "category": "Contracted Professional Services",
        "total": "43157670.46",
        "num_records": 2221
    },
    {
        "year": 2012.42,
        "agency": "Department of Human Services",
        "category": "Benefits",
        "total": "28629866.15",
        "num_records": 186
    },
    {
        "year": 2012.52,
        "agency": "Department of Human Services",
        "category": "Operating Supplies and Expenses",
        "total": "11476966.19",
        "num_records": 10881
    },
    {
        "year": 2012.62,
        "agency": "Department of Human Services",
        "category": "Operating Transfers",
        "total": "6735550.33",
        "num_records": 13
    },
    {
        "year": 2012.72,
        "agency": "Department of Human Services",
        "category": "Capital Purchases and Equipment",
        "total": "403619.57",
        "num_records": 46
    },
    {
        "year": 2013.12,
        "agency": "Department of Human Services",
        "category": "Assistance and Grants",
        "total": "130285837.65",
        "num_records": 4624
    },
    {
        "year": 2013.22,
        "agency": "Department of Human Services",
        "category": "Salary/Wages",
        "total": "24333666.58",
        "num_records": 87
    },
    {
        "year": 2013.32,
        "agency": "Department of Human Services",
        "category": "Contracted Professional Services",
        "total": "14555144.04",
        "num_records": 1887
    },
    {
        "year": 2013.42,
        "agency": "Department of Human Services",
        "category": "Benefits",
        "total": "13298668.94",
        "num_records": 98
    },
    {
        "year": 2013.52,
        "agency": "Department of Human Services",
        "category": "Operating Supplies and Expenses",
        "total": "12385344.74",
        "num_records": 10552
    },
    {
        "year": 2013.62,
        "agency": "Department of Human Services",
        "category": "Operating Transfers",
        "total": "3997605.16",
        "num_records": 11
    },
    {
        "year": 2013.72,
        "agency": "Department of Human Services",
        "category": "Capital Purchases and Equipment",
        "total": "650863.81",
        "num_records": 55
    },
    {
        "year": 2014.12,
        "agency": "Department of Human Services",
        "category": "Assistance and Grants",
        "total": "137163195.7",
        "num_records": 5878
    },
    {
        "year": 2014.22,
        "agency": "Department of Human Services",
        "category": "Contracted Professional Services",
        "total": "15363723.8",
        "num_records": 1921
    },
    {
        "year": 2014.32,
        "agency": "Department of Human Services",
        "category": "Operating Supplies and Expenses",
        "total": "14797532.12",
        "num_records": 14987
    },
    {
        "year": 2014.42,
        "agency": "Department of Human Services",
        "category": "Operating Transfers",
        "total": "5747331.81",
        "num_records": 16
    },
    {
        "year": 2014.52,
        "agency": "Department of Human Services",
        "category": "Capital Purchases and Equipment",
        "total": "2783404.43",
        "num_records": 92
    },
    {
        "year": 2014.62,
        "agency": "Department of Human Services",
        "category": "Benefits",
        "total": "1147.92",
        "num_records": 8
    },
    {
        "year": 2014.72,
        "agency": "Department of Human Services",
        "category": "Salary/Wages",
        "total": "1003.11",
        "num_records": 5
    },
    {
        "year": 2015.12,
        "agency": "Department of Human Services",
        "category": "Assistance and Grants",
        "total": "18500225.32",
        "num_records": 677
    },
    {
        "year": 2015.22,
        "agency": "Department of Human Services",
        "category": "Operating Supplies and Expenses",
        "total": "1945631.51",
        "num_records": 3573
    },
    {
        "year": 2015.32,
        "agency": "Department of Human Services",
        "category": "Contracted Professional Services",
        "total": "1462710.68",
        "num_records": 260
    },
    {
        "year": 2015.42,
        "agency": "Department of Human Services",
        "category": "Capital Purchases and Equipment",
        "total": "380056.21",
        "num_records": 12
    },
    {
        "year": 2015.52,
        "agency": "Department of Human Services",
        "category": "Operating Transfers",
        "total": "200000.0",
        "num_records": 1
    },
    {
        "year": 2015.62,
        "agency": "Department of Human Services",
        "category": "Salary/Wages",
        "total": "108.21",
        "num_records": 1
    },

    { "year": 2010.1, "agency": "Department of Education", "category": "Aid to Local Units of Government", "total": "980457127.47", "num_records": 2476 },
    { "year": 2010.2, "agency": "Department of Education", "category": "Contracted Professional Services", "total": "24951630.58", "num_records": 1103 },
    { "year": 2010.3, "agency": "Department of Education", "category": "Capital Purchases and Equipment", "total": "22034760.55", "num_records": 103 },
    { "year": 2010.4, "agency": "Department of Education", "category": "Salary/Wages", "total": "22025267.21", "num_records": 219 },
    { "year": 2010.5, "agency": "Department of Education", "category": "Assistance and Grants", "total": "15860580.26", "num_records": 818 },
    { "year": 2010.6, "agency": "Department of Education", "category": "Benefits", "total": "11053161.91", "num_records": 217 },
    { "year": 2010.7, "agency": "Department of Education", "category": "Operating Supplies and Expenses", "total": "8447611.18", "num_records": 3689 },
    {
        "year": 2011.1,
        "agency": "Department of Education",
        "category": "Aid to Local Units of Government",
        "total": "1033290512.21",
        "num_records": 2608
    },
    {
        "year": 2011.2,
        "agency": "Department of Education",
        "category": "Contracted Professional Services",
        "total": "30847420.15",
        "num_records": 1145
    },
    {
        "year": 2011.3,
        "agency": "Department of Education",
        "category": "Salary/Wages",
        "total": "22850418.22",
        "num_records": 486
    },
    {
        "year": 2011.4,
        "agency": "Department of Education",
        "category": "Assistance and Grants",
        "total": "15767941.38",
        "num_records": 821
    },
    {
        "year": 2011.5,
        "agency": "Department of Education",
        "category": "Benefits",
        "total": "11956400.08",
        "num_records": 200
    },
    {
        "year": 2011.6,
        "agency": "Department of Education",
        "category": "Operating Supplies and Expenses",
        "total": "9693129.48",
        "num_records": 4031
    },
    {
        "year": 2011.7,
        "agency": "Department of Education",
        "category": "Capital Purchases and Equipment",
        "total": "6441865.89",
        "num_records": 77
    },
    {
        "year": 2012.1,
        "agency": "Department of Education",
        "category": "Aid to Local Units of Government",
        "total": "1020073875.6",
        "num_records": 2660
    },
    {
        "year": 2012.2,
        "agency": "Department of Education",
        "category": "Contracted Professional Services",
        "total": "43604234.05",
        "num_records": 1196
    },
    {
        "year": 2012.3,
        "agency": "Department of Education",
        "category": "Salary/Wages",
        "total": "23674764.29",
        "num_records": 239
    },
    {
        "year": 2012.4,
        "agency": "Department of Education",
        "category": "Assistance and Grants",
        "total": "14487845.99",
        "num_records": 643
    },
    {
        "year": 2012.5,
        "agency": "Department of Education",
        "category": "Benefits",
        "total": "12695790.43",
        "num_records": 209
    },
    {
        "year": 2012.6,
        "agency": "Department of Education",
        "category": "Operating Supplies and Expenses",
        "total": "9899166.84",
        "num_records": 4144
    },
    {
        "year": 2012.7,
        "agency": "Department of Education",
        "category": "Capital Purchases and Equipment",
        "total": "5465978.56",
        "num_records": 139
    },
    {
        "year": 2013.1,
        "agency": "Department of Education",
        "category": "Aid to Local Units of Government",
        "total": "1052100715.27",
        "num_records": 3289
    },
    {
        "year": 2013.2,
        "agency": "Department of Education",
        "category": "Contracted Professional Services",
        "total": "49521762.64",
        "num_records": 1278
    },
    {
        "year": 2013.3,
        "agency": "Department of Education",
        "category": "Assistance and Grants",
        "total": "14443244.36",
        "num_records": 661
    },
    {
        "year": 2013.4,
        "agency": "Department of Education",
        "category": "Salary/Wages",
        "total": "11274120.26",
        "num_records": 91
    },
    {
        "year": 2013.5,
        "agency": "Department of Education",
        "category": "Operating Supplies and Expenses",
        "total": "10926416.29",
        "num_records": 4242
    },
    {
        "year": 2013.6,
        "agency": "Department of Education",
        "category": "Benefits",
        "total": "6096357.85",
        "num_records": 94
    },
    {
        "year": 2013.7,
        "agency": "Department of Education",
        "category": "Capital Purchases and Equipment",
        "total": "3221386.46",
        "num_records": 92
    },
    {
        "year": 2014.1,
        "agency": "Department of Education",
        "category": "Aid to Local Units of Government",
        "total": "1074919134.65",
        "num_records": 3254
    },
    {
        "year": 2014.2,
        "agency": "Department of Education",
        "category": "Contracted Professional Services",
        "total": "42784954.34",
        "num_records": 1253
    },
    {
        "year": 2014.3,
        "agency": "Department of Education",
        "category": "Assistance and Grants",
        "total": "15367534.92",
        "num_records": 721
    },
    {
        "year": 2014.4,
        "agency": "Department of Education",
        "category": "Capital Purchases and Equipment",
        "total": "11851507.95",
        "num_records": 86
    },
    {
        "year": 2014.5,
        "agency": "Department of Education",
        "category": "Operating Supplies and Expenses",
        "total": "10762030.39",
        "num_records": 4253
    },
    {
        "year": 2014.6,
        "agency": "Department of Education",
        "category": "Salary/Wages",
        "total": "228.92",
        "num_records": 1
    },
    {
        "year": 2014.7,
        "agency": "Department of Education",
        "category": "Benefits",
        "total": "0", //-2202.5
        "num_records": 4
    },
    {
        "year": 2015.1,
        "agency": "Department of Education",
        "category": "Aid to Local Units of Government",
        "total": "160209814.87",
        "num_records": 346
    },
    {
        "year": 2015.2,
        "agency": "Department of Education",
        "category": "Capital Purchases and Equipment",
        "total": "3309804.03",
        "num_records": 10
    },
    {
        "year": 2015.3,
        "agency": "Department of Education",
        "category": "Operating Supplies and Expenses",
        "total": "1293133.29",
        "num_records": 333
    },
    {
        "year": 2015.4,
        "agency": "Department of Education",
        "category": "Contracted Professional Services",
        "total": "931145.26",
        "num_records": 67
    },
    {
        "year": 2015.5,
        "agency": "Department of Education",
        "category": "Assistance and Grants",
        "total": "338548.18",
        "num_records": 19
    }
];

	var group1 = dataGroup.map(function(d){                   
        return 	{
        			xCord : d.total,
        			yCord : d.year,
        			info : d.category,
                    info2 : d.agency
        		}; 
    });
    

    data = group1;

				
	var formatPercent = d3.format(".0%");

    //--------------------------------------------------------------------------------------------------------
	//
	// THE VIEW
    //
	//--------------------------------------------------------------------------------------------------------
		// create the margins in which the graph will be build in

	var margin 	= 	{top: 80, right: 20, bottom: 30, left: 40},
	    width 	= 	960 - margin.left - margin.right,
	    height 	= 	500 - margin.top - margin.bottom;


	// empty placeholder for everything to come
	var svg 	= 	d3.select("body").append("svg")
	    				.attr("width", width + margin.left + margin.right)
	    				.attr("height", height + margin.top + margin.bottom)
	  				.append("g")
	    				.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
	// these are redundent but they help make clear the seperation of the different parts of the graph
	var svgBar	= svg;

	var svgAx 	= svg;


	//--------------------------------------------------------------------------------------------------------
		// create the two domains of the graph

	var x 		= 	d3.scale.ordinal()
		    			.rangeRoundBands([0, width], .1, 1)
						.domain(data.map(function(d) { return d.yCord; }));


    				

	var y 		= 	d3.scale.linear()
	    				.range([height, 0])
	    				.domain([0, 1074919135]);  //1074919135 (department of ed)  160000000 human services




	//--------------------------------------------------------------------------------------------------------
	//
	// THE VIEW... visual section      	
	//
	//--------------------------------------------------------------------------------------------------------
	


    //--------------------------------------------------------------------------------------------------------
	// create the tips

    var tip = d3.tip()
		  	.attr('class', 'd3-tip')
		  	.offset([-10, 0])
		  	.html(function(d) {
		    	return "<strong>total:</strong> <span style='color:#E5FFAF'>" + "$" + d.xCord + "</span><br>" + d.info + "<br>" + Math.floor(d.yCord)+ "<br>" + d.info2;
  			});


	

	//--------------------------------------------------------------------------------------------------------
		// create the axis	

	// function updateAxis(d) {

	var xAx 	= 	d3.svg.axis()
				.scale(x)
				.orient("bottom");

	var	yAx 	= 	d3.svg.axis()
				.scale(y)
				.orient("left");
				// .ticks(10, "%"),
				// .tickFormat(formatPercent);

	var	xAxRender = svgAx.append("g")
			    .attr("class", "x axis")
			    .attr("transform", "translate(0," + height + ")")
			.call(xAx);

	var	yAxRender = svgAx.append("g")
		      	.attr("class", "y axis")
			.call(yAx).append("text")
			    .attr("transform", "rotate(-90)")
			    .attr("y", 6)
			    .attr("dy", ".71em")
			    .style("text-anchor", "end")
			    .text("Frequency");
	// }
		    
	
	
	//--------------------------------------------------------------------------------------------------------
		// create the bars


	// function updatebar(d) {
	var barRender = svgBar.selectAll(".bar")
		    .data(data)
		.enter().append("rect")
		    .attr("class", "bar")
	      	.attr("x", function(d) { return x(d.yCord); })
	      	.attr("width", x.rangeBand())
	      	.attr("y", function(d) { return y(d.xCord); })
	      	.attr("height", function(d) { return height - y(d.xCord); });
	      	
	      	// hover animation 
	      	barRender.on('mouseover', tip.show)
      			.on('mouseout', tip.hide);

    // }



    //--------------------------------------------------------------------------------------------------------
	// animation


		
	function change() {

	    clearTimeout(sortTimeout);

	    // Copy-on-write since tweens are evaluated after a delay.
	    var x0 = x.domain(data.sort(this.checked
	        ? function(a, b) { return b.xCord - a.xCord; }
	        : function(a, b) { return d3.ascending(a.yCord, b.yCord); })
	        .map(function(d) { return d.yCord; }))
	        .copy();

	    var transition = svg.transition().duration(750),
	        delay = function(d, i) { return i * 25; };

	    transition.selectAll(".bar")
	        .delay(delay)
	        .attr("x", function(d) { return x0(d.yCord); });

	    transition.select(".x.axis")
	        .call(xAx)
	      .selectAll("g")
	        .delay(delay);


	  }
	

  

	//--------------------------------------------------------------------------------------------------------
		// run program


	// updateAxis(data);
	// updatebar(data);
	
	// run the tips
	svg.call(tip);
    
    // set a timeout on the change
	var sortTimeout = setTimeout(function() {
		d3.select("input").on("change", change) 
	    	.property("checked", true)
	    	.each(change);
	},3000);
